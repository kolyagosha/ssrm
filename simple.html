<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSRM | Visual Mode</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body {
            background: radial-gradient(circle at center, #1a1a2e 0%, #000000 100%);
            color: #fff;
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            overflow: hidden;
        }

        /* –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤ */
        .mode-switch {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
            text-decoration: none;
            color: #00d4ff;
            border: 1px solid #00d4ff;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            transition: 0.3s;
            background: rgba(0,0,0,0.5);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .mode-switch:hover { background: #00d4ff; color: #000; }

        /* –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å (–≤–Ω–∏–∑—É) */
        #controls-simple {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 600px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            border: 1px solid rgba(255,255,255,0.2);
            z-index: 10;
        }

        .slider-group { display: flex; align-items: center; gap: 15px; }
        .icon { width: 30px; font-size: 1.2rem; text-align: center; }
        .label { width: 80px; font-size: 0.9rem; font-weight: bold; color: #ccc; }
        
        input[type=range] {
            flex-grow: 1;
            -webkit-appearance: none;
            background: rgba(255,255,255,0.2);
            height: 4px;
            border-radius: 2px;
            outline: none;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px; height: 20px;
            border-radius: 50%;
            cursor: pointer;
            background: #fff;
            box-shadow: 0 0 10px rgba(255,255,255,0.5);
            transition: 0.2s;
        }
        input[type=range]:hover::-webkit-slider-thumb { transform: scale(1.2); }

        /* –°—Ç–∞—Ç—É—Å –ø–æ —Ü–µ–Ω—Ç—Ä—É */
        #status-container {
            position: absolute;
            top: 15%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            pointer-events: none; /* –ß—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∫—Ä—É—Ç–∏—Ç—å –º–æ–¥–µ–ª—å —Å–∫–≤–æ–∑—å —Ç–µ–∫—Å—Ç */
            z-index: 5;
        }
        #main-status { font-size: 2.5rem; font-weight: 300; letter-spacing: 5px; text-transform: uppercase; text-shadow: 0 0 20px rgba(255,255,255,0.3); }
        #sub-status { font-size: 1rem; color: #aaa; margin-top: 5px; }

        /* –¶–≤–µ—Ç–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ */
        .status-good { color: #00ff88; }
        .status-warn { color: #ffae00; }
        .status-bad { color: #ff4757; }

        #canvas-container { width: 100vw; height: 100vh; }
    </style>
</head>
<body>

    <a href="index.html" class="mode-switch">‚Üê Expert Mode</a>

    <div id="status-container">
        <div id="main-status" class="status-good">HARMONY</div>
        <div id="sub-status">Your Relationship Crystal is stable</div>
    </div>

    <div id="controls-simple">
        <div class="slider-group">
            <div class="icon">üí∞</div>
            <div class="label">Resources</div>
            <input type="range" min="0.1" max="1" step="0.01" value="0.7" oninput="updateAll('x', this.value)">
        </div>
        <div class="slider-group">
            <div class="icon">üè†</div>
            <div class="label">Stability</div>
            <input type="range" min="0.1" max="1" step="0.01" value="0.7" oninput="updateAll('y', this.value)">
        </div>
        <div class="slider-group">
            <div class="icon">üöÄ</div>
            <div class="label">Growth</div>
            <input type="range" min="0.1" max="1" step="0.01" value="0.7" oninput="updateAll('z', this.value)">
        </div>
    </div>

    <div id="canvas-container"></div>

    <script>
        // === –î–∞–Ω–Ω—ã–µ ===
        // –í —É–ø—Ä–æ—â–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –º—ã –Ω–µ–º–Ω–æ–≥–æ "—á–∏—Ç–µ—Ä–∏–º" –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:
        // –ü–æ–ª–∑—É–Ω–æ–∫ Resources –º–µ–Ω—è–µ—Ç X —É –æ–±–æ–∏—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ —Å—Ä–∞–∑—É, –∏ —Ç.–¥.
        // –≠—Ç–æ —á—Ç–æ–±—ã "–¥–æ–º–æ—Ö–æ–∑—è–π–∫–∞" –≤–∏–¥–µ–ª–∞ —ç—Ñ—Ñ–µ–∫—Ç, –Ω–µ –¥–≤–∏–≥–∞—è 9 –ø–æ–ª–∑—É–Ω–∫–æ–≤.
        const state = {
            v1: { x: 0.7, y: 0.7, z: 0.7 },
            v2: { x: 0.7, y: 0.7, z: 0.7 },
            w:  { x: 0.8, y: 0.8, z: 0.8 } 
        };

        // === –°—Ü–µ–Ω–∞ ===
        const scene = new THREE.Scene();
        // –ö—Ä–∞—Å–∏–≤—ã–π —Ç—É–º–∞–Ω –¥–ª—è –≥–ª—É–±–∏–Ω—ã
        scene.fog = new THREE.FogExp2(0x000000, 0.02);

        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(4, 3, 5);
        camera.lookAt(0, 0, 0);

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.outputEncoding = THREE.sRGBEncoding;
        document.getElementById('canvas-container').appendChild(renderer.domElement);

        // === –û—Å–≤–µ—â–µ–Ω–∏–µ (–ö–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–Ω–æ–µ) ===
        const ambientLight = new THREE.AmbientLight(0x404040, 1);
        scene.add(ambientLight);

        // –°–∏–Ω–∏–π —Å–≤–µ—Ç —Å–ª–µ–≤–∞
        const spotLight1 = new THREE.SpotLight(0x00d4ff, 5);
        spotLight1.position.set(-5, 5, 0);
        spotLight1.castShadow = true;
        scene.add(spotLight1);

        // –¢–µ–ø–ª—ã–π —Å–≤–µ—Ç —Å–ø—Ä–∞–≤–∞
        const spotLight2 = new THREE.SpotLight(0xffae00, 5);
        spotLight2.position.set(5, -2, 2);
        scene.add(spotLight2);

        // –†–æ–∑–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–≤–æ–π —Å–≤–µ—Ç
        const spotLight3 = new THREE.SpotLight(0xbd00ff, 3);
        spotLight3.position.set(0, 5, -5);
        scene.add(spotLight3);

        let crystalMesh = null;

        // === –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –æ–±—ä–µ–º–∞ ===
        function calculateVolume(v1, v2, w) {
            const cx = v1.y * v2.z - v1.z * v2.y;
            const cy = v1.z * v2.x - v1.x * v2.z;
            const cz = v1.x * v2.y - v1.y * v2.x;
            const dot = cx * w.x + cy * w.y + cz * w.z;
            return Math.abs(dot) / 6.0;
        }

        // === –°–æ–∑–¥–∞–Ω–∏–µ –ö—Ä–∏—Å—Ç–∞–ª–ª–∞ ===
        function updateCrystal() {
            if (crystalMesh) scene.remove(crystalMesh);

            // –í–µ—Ä—à–∏–Ω—ã
            const vertices = [
                0, 0, 0,
                state.v1.x, state.v1.y, state.v1.z,
                state.v2.x, state.v2.y, state.v2.z,
                state.w.x,  state.w.y,  state.w.z
            ];

            const indices = [
                0, 2, 1, 0, 3, 2, 0, 1, 3, 1, 2, 3
            ];

            const geometry = new THREE.BufferGeometry();
            geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
            geometry.setIndex(indices);
            geometry.computeVertexNormals(); // –í–∞–∂–Ω–æ –¥–ª—è –±–ª–∏–∫–æ–≤!

            // –†–∞—Å—á–µ—Ç —Å—Ç–∞—Ç—É—Å–∞
            const vol = calculateVolume(state.v1, state.v2, state.w);
            let colorHex = 0xffffff;
            let statusText = "HARMONY";
            let statusClass = "status-good";
            let subText = "Crystal is shining bright";

            // –õ–æ–≥–∏–∫–∞ "–ø–æ–ª–æ–º–∫–∏" –∫—Ä–∏—Å—Ç–∞–ª–ª–∞
            if (vol < 0.05) {
                colorHex = 0xffae00; // –ñ–µ–ª—Ç–µ–µ—Ç
                statusText = "FADING";
                statusClass = "status-warn";
                subText = "Adding energy needed...";
            }
            if (vol < 0.02) {
                colorHex = 0xff0000; // –ö—Ä–∞—Å–Ω–µ–µ—Ç
                statusText = "CRITICAL";
                statusClass = "status-bad";
                subText = "Structure collapsing!";
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
            const mainStatus = document.getElementById('main-status');
            mainStatus.innerText = statusText;
            mainStatus.className = statusClass;
            document.getElementById('sub-status').innerText = subText;

            // –ú–∞—Ç–µ—Ä–∏–∞–ª "–°—Ç–µ–∫–ª–æ/–ö—Ä–∏—Å—Ç–∞–ª–ª"
            const material = new THREE.MeshPhysicalMaterial({
                color: colorHex,
                metalness: 0.1,
                roughness: 0.1,
                transmission: 0.6, // –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å —Å—Ç–µ–∫–ª–∞
                thickness: 1.5, // –¢–æ–ª—â–∏–Ω–∞ –ø—Ä–µ–ª–æ–º–ª–µ–Ω–∏—è
                clearcoat: 1.0, // –õ–∞–∫ —Å–≤–µ—Ä—Ö—É
                clearcoatRoughness: 0.1,
                emissive: colorHex,
                emissiveIntensity: vol < 0.02 ? 0.5 : 0.1, // –°–≤–µ—Ç–∏—Ç—Å—è –µ—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ
            });

            crystalMesh = new THREE.Mesh(geometry, material);
            scene.add(crystalMesh);
        }

        // === –£–ø—Ä–æ—â–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ===
        // –î–≤–∏–≥–∞–µ–º —Å—Ä–∞–∑—É –≤—Å–µ –≤–µ–∫—Ç–æ—Ä–∞ –ø–æ –æ–¥–Ω–æ–π –æ—Å–∏, —á—Ç–æ–±—ã —Ñ–æ—Ä–º–∞ –º–µ–Ω—è–ª–∞—Å—å —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ –∏ –∫—Ä–∞—Å–∏–≤–æ
        window.updateAll = function(axis, val) {
            const numVal = parseFloat(val);
            // –ù–µ–º–Ω–æ–≥–æ —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä—É–µ–º, —á—Ç–æ–±—ã –≤–µ–∫—Ç–æ—Ä–∞ –Ω–µ —Å–ª–∏–ø–∞–ª–∏—Å—å (–∏–Ω–∞—á–µ –æ–±—ä–µ–º –±—É–¥–µ—Ç 0)
            state.v1[axis] = numVal; 
            state.v2[axis] = numVal * 0.9; // –ß—É—Ç—å –º–µ–Ω—å—à–µ –¥–ª—è Partner 2
            state.w[axis]  = numVal * 1.1; // –ß—É—Ç—å –±–æ–ª—å—à–µ –¥–ª—è Synergy
            
            updateCrystal();
        };

        // –ê–Ω–∏–º–∞—Ü–∏—è
        function animate() {
            requestAnimationFrame(animate);
            if(crystalMesh) {
                crystalMesh.rotation.y += 0.005; // –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ
                crystalMesh.rotation.x = Math.sin(Date.now() * 0.001) * 0.1; // –õ–µ–≥–∫–æ–µ –ø–æ–∫–∞—á–∏–≤–∞–Ω–∏–µ
            }
            renderer.render(scene, camera);
        }

        updateCrystal();
        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
